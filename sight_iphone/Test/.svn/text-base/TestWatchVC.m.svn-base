//
//  TestWatchVC.m
//  sight_iphone
//
//  Created by fengshaobo on 15/4/26.
//  Copyright (c) 2015年 fengshaobo. All rights reserved.
//

#import "TestWatchVC.h"
#import "UITableView+Utility.h"

@interface TestWatchVC ()

@end

@implementation TestWatchVC

- (void)viewDidLoad {
    [super viewDidLoad];
    
    // step1 : 重设frame
    CGRect rect = self.view.frame;
    [[NSBundle mainBundle] loadNibNamed:@"TestWatchVC" owner:self options:nil];
    self.view.frame = rect;
    
    // step2 : navbar
    [self layoutRootViewDefault:self.view];
    [naviBar setTitle:@"WATCH DEMO"];
    [self stopLoading:YES];
    
    NaviBarItem *backItem = [[NaviBarItem alloc] initBackItem:self action:@selector(goBack:)];
    [naviBar setLeftBarItem:backItem];
    
    
    self.table.frame = viewContent.bounds;
    [viewContent addSubview:self.table];
    
    self.counterData = [NSMutableArray array];
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receiveDataNotifi:) name:notifi_receive_watchapp_data object:nil];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}


- (void)receiveDataNotifi:(NSNotification *)info
{
    NSString *counterValue = [[info userInfo] objectForKey:@"counterValue"];
    if (NO == isEmptyString(counterValue)) {
        [self.counterData addObject:counterValue];
        [self.table reloadData];
    }
}

- (void)receiveData:(NSString *)str
{
    if (NO == isEmptyString(str)) {
        [self.counterData addObject:str];
        [self.table reloadData];
    }
}

#pragma mark - UITableViewDelegate

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return self.counterData.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    
    static NSString *cellIdentifier = @"CounterCell";
    UITableViewCell *cell = [tableView cellForIdentifier:cellIdentifier];
    NSString *counterValueString = [self.counterData objectAtIndex:indexPath.row];
    cell.textLabel.text =counterValueString;
    return cell;
}

-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return 44;
}

@end
