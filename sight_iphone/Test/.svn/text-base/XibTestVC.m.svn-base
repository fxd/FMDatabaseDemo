//
//  XibTestVC.m
//  byy_iphone
//
//  Created by fengshaobo on 15/3/5.
//  Copyright (c) 2015年 fengshaobo. All rights reserved.
//

#import "XibTestVC.h"
#import "NetworkAPI.h"
#import "TestResult.h"


@interface XibTestVC ()

@property (nonatomic, strong) TestResult *info;

@end

@implementation XibTestVC

- (void)viewDidLoad
{
    [super viewDidLoad];
    
    // step1 : 重设frame
    CGRect rect = self.view.frame;
    [[NSBundle mainBundle] loadNibNamed:@"XibTestVC" owner:self options:nil];
    self.view.frame = rect;
    
    [self layoutRootViewDefault:self.view];
    
    NaviBarItem *backItem = [[NaviBarItem alloc] initBackItem:self action:@selector(goBack:)];
    [naviBar setLeftBarItem:backItem];
    [naviBar setTitle:@"xib 测试"];
    
    // step2 : 将内容加到viewContent上
    [viewContent addSubview:_btn];
    [viewContent addSubview:_apiBtn];

    [self stopLoading:YES];


}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)btnAction:(id)sender
{
    [[VCManager mainVCC] popWithAnimation:[VCAnimationClassic defaultAnimation]];
}

// 测试api
- (IBAction)apiTestAction:(id)sender
{
    NSMutableDictionary *dict = [NSMutableDictionary dictionary];
    [dict setObjectSafe:@"12" forKey:@"uid"];
    [dict setObjectSafe:@"longge" forKey:@"unmae"];

    
    [[NetworkAPI sharedInstance] apiPost:@"/user/test" withParam:nil respondData:[[TestResult alloc] init] result:^(APIStatus status, id data , AFHTTPRequestOperation* operation) {
        
        if (ELoading == status) {
            // loading view 显示
        }
        else if (ESuccess == status) {
            //[[data networkStatus] code];
            
            NSInteger code = [[[data networkStatus] returnCode] integerValue];
            if (1 == code) {
                
                NSLog(@"self.info:%@",data);
                self.info = data;
                
//                NSLog(@"testname = %@",_info.testname);
//                NSLog(@"testid = %@",_info.testid);
//                NSLog(@"testinfo = %@",_info.testinfo);
                
            }
            else if (code) {
                
            }
            
        }
        else if (EFailure == status) {
            NSLog(@"fail");
        }
        
        
    }];

}


@end
